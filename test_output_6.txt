
[1m[46m RUN [49m[22m [36mv4.0.15 [39m[90m/app[39m

 [32mâœ“[39m src/lib/tts/MediaSessionManager.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 38[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioPlayerService_SmartResume.test.ts [2m([22m[2m8 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[32m 25[2mms[22m[39m
[90mstderr[2m | src/lib/BackupService.test.ts[2m > [22m[2mBackupService[2m > [22m[2mcreateFullBackup[2m > [22m[2mshould skip offloaded books
[22m[39mSkipping offloaded book b1 in full backup

[90mstderr[2m | src/lib/BackupService.test.ts[2m > [22m[2mBackupService[2m > [22m[2mrestoreBackup[2m > [22m[2mshould reject backup with invalid book metadata (missing id)
[22m[39mDB Validation: Record missing required fields: id { title: [32m'No ID'[39m, author: [32m'Author'[39m, addedAt: [33m1766214484609[39m }
Skipping invalid book record in backup { title: [32m'No ID'[39m, author: [32m'Author'[39m, addedAt: [33m1766214484609[39m }

[90mstderr[2m | src/lib/BackupService.test.ts[2m > [22m[2mBackupService[2m > [22m[2mrestoreBackup[2m > [22m[2mshould always sanitize metadata
[22m[39mMetadata sanitized for backup book "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa": [ [32m'Title sanitized (HTML removed or truncated by 2500 characters)'[39m ]

 [32mâœ“[39m src/lib/BackupService.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 93[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/CsvUtils.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 37[2mms[22m[39m
[90mstderr[2m | src/db/DBService.test.ts[2m > [22m[2mDBService[2m > [22m[2maddBook[2m > [22m[2mshould handle error
[22m[39m[DBService] Database operation failed Error: Ingestion failed
    at [90m/app/[39msrc/db/DBService.test.ts:39:58
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1206:10[90m)[39m
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1650:37
    at Traces.$ [90m(file:///app/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///app/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1650:12[90m)[39m

[90mstderr[2m | src/db/DBService.test.ts[2m > [22m[2mDBService[2m > [22m[2mgetLibrary[2m > [22m[2mshould filter invalid books
[22m[39mDB Validation: Record missing required fields: title, author { id: [32m'3'[39m, addedAt: [33m300[39m }
[DBService] DB Integrity: Found corrupted book record { id: [32m'3'[39m, addedAt: [33m300[39m }

 [32mâœ“[39m src/integration.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 149[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/providers/WebSpeechProvider.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mâœ“[39m src/db/DBService.test.ts [2m([22m[2m11 tests[22m[2m)[22m[33m 1157[2mms[22m[39m
       [33m[2mâœ“[22m[39m should save progress debounced [33m 1102[2mms[22m[39m
 [32mâœ“[39m src/lib/search.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 198[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioPlayerService_MediaSession.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 23[2mms[22m[39m
[90mstderr[2m | src/components/reader/ReadingHistoryPanel.test.tsx[2m > [22m[2mReadingHistoryPanel[2m > [22m[2mrenders "Loading history..." initially
[22m[39mWarning: An update to ReadingHistoryPanel inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at ReadingHistoryPanel (/app/src/components/reader/ReadingHistoryPanel.tsx:10:32)
Warning: An update to ReadingHistoryPanel inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at ReadingHistoryPanel (/app/src/components/reader/ReadingHistoryPanel.tsx:10:32)

[90mstderr[2m | src/components/reader/ReadingHistoryPanel.test.tsx[2m > [22m[2mReadingHistoryPanel[2m > [22m[2mhandles errors in book.spine.get gracefully
[22m[39mFailed to get section from CFI Error: Invalid CFI
    at Object.<anonymous> [90m(/app/[39msrc/components/reader/ReadingHistoryPanel.test.tsx:111:15[90m)[39m
    at Object.Mock [as get] [90m(file:///app/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at processItem [90m(/app/[39msrc/components/reader/ReadingHistoryPanel.tsx:67:50[90m)[39m
    at loadHistory [90m(/app/[39msrc/components/reader/ReadingHistoryPanel.tsx:117:42[90m)[39m

 [32mâœ“[39m src/components/reader/ReadingHistoryPanel.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[32m 163[2mms[22m[39m
[90mstderr[2m | src/lib/ingestion.test.ts[2m > [22m[2mingestion[2m > [22m[2mshould always sanitize metadata
[22m[39mMetadata sanitized for "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA": [ [32m'Title sanitized (HTML removed or truncated by 100 characters)'[39m ]

 [32mâœ“[39m src/lib/ingestion.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 94[2mms[22m[39m
 [32mâœ“[39m src/db/DBService.readingHistory.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 24[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/providers/CapacitorTTSProvider.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 15[2mms[22m[39m
 [32mâœ“[39m src/store/useLibraryStore.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 56[2mms[22m[39m
 [32mâœ“[39m src/db/DBService.readingList.test.ts [2m([22m[2m5 tests[22m[2m)[22m[33m 2242[2mms[22m[39m
     [33m[2mâœ“[22m[39m should save to reading list when saving progress [33m 1104[2mms[22m[39m
     [33m[2mâœ“[22m[39m should preserve rating and isbn when updating progress [33m 1103[2mms[22m[39m
[90mstderr[2m | src/components/reader/tests/ReaderView.test.tsx[2m > [22m[2mReaderView[2m > [22m[2minitializes epub.js and renders book
[22m[39m[TTS] Could not get current location TypeError: rendition.currentLocation is not a function
    at loadSentences [90m(/app/[39msrc/hooks/useTTS.ts:56:59[90m)[39m
    at [90m/app/[39msrc/hooks/useTTS.ts:127:9
    at commitHookEffectListMount [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:23189:26[90m)[39m
    at commitPassiveMountOnFiber [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24970:11[90m)[39m
    at commitPassiveMountEffects_complete [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24930:9[90m)[39m
    at commitPassiveMountEffects_begin [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24917:7[90m)[39m
    at commitPassiveMountEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24905:3[90m)[39m
    at flushPassiveEffectsImpl [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27078:3[90m)[39m
    at flushPassiveEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27023:14[90m)[39m
    at [90m/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:26808:9

[90mstderr[2m | src/components/reader/tests/ReaderView.test.tsx[2m > [22m[2mReaderView[2m > [22m[2mtoggles TOC
[22m[39m[TTS] Could not get current location TypeError: rendition.currentLocation is not a function
    at loadSentences [90m(/app/[39msrc/hooks/useTTS.ts:56:59[90m)[39m
    at [90m/app/[39msrc/hooks/useTTS.ts:127:9
    at commitHookEffectListMount [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:23189:26[90m)[39m
    at commitPassiveMountOnFiber [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24970:11[90m)[39m
    at commitPassiveMountEffects_complete [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24930:9[90m)[39m
    at commitPassiveMountEffects_begin [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24917:7[90m)[39m
    at commitPassiveMountEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24905:3[90m)[39m
    at flushPassiveEffectsImpl [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27078:3[90m)[39m
    at flushPassiveEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27023:14[90m)[39m
    at [90m/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:26808:9

[90mstderr[2m | src/components/reader/tests/ReaderView.test.tsx[2m > [22m[2mReaderView[2m > [22m[2mupdates settings
[22m[39m[TTS] Could not get current location TypeError: rendition.currentLocation is not a function
    at loadSentences [90m(/app/[39msrc/hooks/useTTS.ts:56:59[90m)[39m
    at [90m/app/[39msrc/hooks/useTTS.ts:127:9
    at commitHookEffectListMount [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:23189:26[90m)[39m
    at commitPassiveMountOnFiber [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24970:11[90m)[39m
    at commitPassiveMountEffects_complete [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24930:9[90m)[39m
    at commitPassiveMountEffects_begin [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24917:7[90m)[39m
    at commitPassiveMountEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24905:3[90m)[39m
    at flushPassiveEffectsImpl [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27078:3[90m)[39m
    at flushPassiveEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27023:14[90m)[39m
    at commitRootImpl [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:26974:5[90m)[39m

 [32mâœ“[39m src/components/audio/CompassPill.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[32m 89[2mms[22m[39m
 [32mâœ“[39m src/components/reader/tests/ReaderView.test.tsx [2m([22m[2m4 tests[22m[2m | [22m[33m1 skipped[39m[2m)[22m[33m 994[2mms[22m[39m
     [33m[2mâœ“[22m[39m toggles TOC [33m 311[2mms[22m[39m
     [33m[2mâœ“[22m[39m updates settings [33m 484[2mms[22m[39m
 [32mâœ“[39m src/components/reader/ReadingHistoryIntegration.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 119[2mms[22m[39m
[90mstderr[2m | src/lib/tts/AudioPlayerService.test.ts[2m > [22m[2mAudioPlayerService[2m > [22m[2mshould handle fallback from cloud to local on error
[22m[39mPlay error Error: API Quota Exceeded
    at [90m/app/[39msrc/lib/tts/AudioPlayerService.test.ts:131:45
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1240:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1206:10[90m)[39m
    at [90mfile:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1650:37
    at Traces.$ [90m(file:///app/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///app/[39mnode_modules/[4mvitest[24m/dist/chunks/test.BT8LKgU9.js:239:21[90m)[39m
    at runTest [90m(file:///app/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1650:12[90m)[39m
Falling back to local provider...

 [32mâœ“[39m src/lib/tts/AudioPlayerService.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 45[2mms[22m[39m
 [32mâœ“[39m src/hooks/useTTS.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 39[2mms[22m[39m
 [32mâœ“[39m src/components/reader/tests/TTSQueue_AutoScroll.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[32m 97[2mms[22m[39m
 [32mâœ“[39m src/components/reader/TTSAbbreviationSettings.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[32m 178[2mms[22m[39m
[90mstderr[2m | src/components/library/BookCard.test.tsx[2m > [22m[2mBookCard[2m > [22m[2mshould open delete confirmation dialog and delete book
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/library/BookCard.test.tsx[2m > [22m[2mBookCard[2m > [22m[2mshould open delete confirmation dialog and delete book
[22m[39mWarning: An update to null inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)

[90mstderr[2m | src/components/library/BookCard.test.tsx[2m > [22m[2mBookCard[2m > [22m[2mshould open delete confirmation dialog and delete book
[22m[39mWarning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:93:64
    at /app/src/components/ui/Modal.tsx:23:58
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to FocusScope inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at file:///app/node_modules/@radix-ui/react-focus-scope/dist/index.mjs:15:5
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:206:13
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:132:58
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to DismissableLayer inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at file:///app/node_modules/@radix-ui/react-dismissable-layer/dist/index.mjs:24:7
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/dist/index.mjs:15:5
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:206:13
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:132:58
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:93:64
    at /app/src/components/ui/Modal.tsx:23:58
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:93:64
    at /app/src/components/ui/Modal.tsx:23:58
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to FocusScope inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at file:///app/node_modules/@radix-ui/react-focus-scope/dist/index.mjs:15:5
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:206:13
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:132:58
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to DismissableLayer inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at file:///app/node_modules/@radix-ui/react-dismissable-layer/dist/index.mjs:24:7
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/dist/index.mjs:15:5
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:206:13
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:132:58
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:93:64
    at /app/src/components/ui/Modal.tsx:23:58
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to FocusScope inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at file:///app/node_modules/@radix-ui/react-focus-scope/dist/index.mjs:15:5
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:206:13
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:132:58
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to DismissableLayer inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at file:///app/node_modules/@radix-ui/react-dismissable-layer/dist/index.mjs:24:7
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-focus-scope/dist/index.mjs:15:5
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:206:13
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:132:58
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:123:64
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:33:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-slot/dist/index.mjs:9:13
    at file:///app/node_modules/@radix-ui/react-portal/node_modules/@radix-ui/react-primitive/dist/index.mjs:28:13
    at file:///app/node_modules/@radix-ui/react-portal/dist/index.mjs:11:22
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)
Warning: An update to Presence inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at Presence (file:///app/node_modules/@radix-ui/react-presence/dist/index.mjs:19:11)
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at DialogPortal (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:85:11)
    at /app/src/components/ui/Modal.tsx:43:58
    at Provider (file:///app/node_modules/@radix-ui/react-context/dist/index.mjs:27:15)
    at Dialog (file:///app/node_modules/@radix-ui/react-dialog/dist/index.mjs:25:5)
    at Dialog (/app/src/components/ui/Dialog.tsx:8:19)
    at div
    at /app/src/components/library/BookCard.tsx:30:56
    at Router (/app/node_modules/react-router/dist/umd/react-router.development.js:1207:17)
    at BrowserRouter (/app/node_modules/react-router-dom/dist/umd/react-router-dom.development.js:695:7)

 [32mâœ“[39m src/components/library/BookCard.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 1007[2mms[22m[39m
     [33m[2mâœ“[22m[39m should open delete confirmation dialog and delete book [33m 510[2mms[22m[39m
 [32mâœ“[39m src/components/library/LibraryView.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 216[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/providers/GoogleTTSProvider.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 37[2mms[22m[39m
[90mstderr[2m | src/db/validators.test.ts[2m > [22m[2mvalidators[2m > [22m[2msanitizeString[2m > [22m[2muses safe fallback (escaping) if DOMParser is missing
[22m[39mUsing fallback HTML escaping for sanitization.

[90mstderr[2m | src/db/validators.test.ts[2m > [22m[2mvalidators[2m > [22m[2mgetSanitizedBookMetadata[2m > [22m[2mreturns null for invalid structure
[22m[39mDB Validation: Invalid record (not an object) [1mnull[22m
DB Validation: Record missing required fields: id, title, author, addedAt {}

 [32mâœ“[39m src/db/validators.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 68[2mms[22m[39m
 [32mâœ“[39m src/store/useTTSStore_platform.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioPlayerService_Concurrency.test.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 624[2mms[22m[39m
     [33m[2mâœ“[22m[39m should handle rapid play calls by executing only the last one [33m 516[2mms[22m[39m
[90mstderr[2m | src/store/useAnnotationStore.test.ts[2m > [22m[2museAnnotationStore[2m > [22m[2mshould delete annotation
[22m[39mWarning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

[90mstderr[2m | src/store/useAnnotationStore.test.ts[2m > [22m[2museAnnotationStore[2m > [22m[2mshould update annotation
[22m[39mWarning: An update to TestComponent inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at TestComponent (/app/node_modules/@testing-library/react/dist/pure.js:329:5)

 [32mâœ“[39m src/store/useAnnotationStore.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 46[2mms[22m[39m
 [32mâœ“[39m src/components/reader/tests/UnifiedInputController_Immersive.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 72[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/BackgroundAudio.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m src/lib/cfi-utils.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 12[2mms[22m[39m
[90mstdout[2m | src/lib/search-engine.comprehensive.test.ts[2m > [22m[2mSearchEngine Comprehensive Tests[2m > [22m[2mshould handle large text without crashing
[22m[39mLarge text search excerpt generation took 1.1584779999998318ms

 [32mâœ“[39m src/lib/search-engine.comprehensive.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mâœ“[39m src/lib/tts.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 98[2mms[22m[39m
 [32mâœ“[39m src/hooks/useEpubReader_History.test.tsx [2m([22m[2m1 test[22m[2m)[22m[32m 74[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioPlayerService_Critical.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 20[2mms[22m[39m
[90mstderr[2m | src/App_Capacitor.test.tsx[2m > [22m[2mApp Capacitor Initialization[2m > [22m[2mshould initialize Android ForegroundService when platform is android
[22m[39mWarning: An update to App inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at App (/app/src/App.tsx:39:69)

[90mstderr[2m | src/App_Capacitor.test.tsx[2m > [22m[2mApp Capacitor Initialization[2m > [22m[2mshould not initialize Android ForegroundService when platform is web
[22m[39mWarning: An update to App inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at App (/app/src/App.tsx:39:69)

[90mstderr[2m | src/App_Capacitor.test.tsx[2m > [22m[2mApp Capacitor Initialization[2m > [22m[2mshould call AudioPlayerService.pause when notification button is clicked
[22m[39mWarning: An update to App inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
    at App (/app/src/App.tsx:39:69)

 [32mâœ“[39m src/App_Capacitor.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 57[2mms[22m[39m
[90mstderr[2m | src/components/GlobalSettingsDialog.test.tsx[2m > [22m[2mGlobalSettingsDialog - Piper TTS[2m > [22m[2mrenders Piper settings when provider is Piper
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32mâœ“[39m src/components/reader/tests/AnnotationList.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 409[2mms[22m[39m
[90mstderr[2m | src/components/GlobalSettingsDialog.test.tsx[2m > [22m[2mGlobalSettingsDialog - Piper TTS[2m > [22m[2mshows download progress
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/GlobalSettingsDialog.test.tsx[2m > [22m[2mGlobalSettingsDialog - Piper TTS[2m > [22m[2mtriggers download on button click
[22m[39m`DialogContent` requires a `DialogTitle` for the component to be accessible for screen reader users.

If you want to hide the `DialogTitle`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/dialog
Warning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32mâœ“[39m src/components/GlobalSettingsDialog.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[33m 841[2mms[22m[39m
     [33m[2mâœ“[22m[39m renders Piper settings when provider is Piper [33m 498[2mms[22m[39m
[90mstdout[2m | src/hooks/useTTS_NoText.test.ts[2m > [22m[2museTTS - No Text Behavior[2m > [22m[2mshould populate queue with a random "no text" message when extraction returns empty
[22m[39mGenerated message: Silence fills this chapter.

 [32mâœ“[39m src/hooks/useTTS_NoText.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 43[2mms[22m[39m
 [32mâœ“[39m src/components/library/FileUploader.test.tsx [2m([22m[2m6 tests[22m[2m)[22m[32m 215[2mms[22m[39m
[90mstderr[2m | src/lib/ingestion.integration.test.ts[2m > [22m[2mingestion integration[2m > [22m[2mshould process a real epub file (Alice in Wonderland) and extract metadata + cover
[22m[39mSkipping binary comparison: Stored file appears to be empty object or invalid in this test environment. This is likely a fake-indexeddb/JSDOM limitation with File objects.

 [32mâœ“[39m src/lib/ingestion.integration.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 366[2mms[22m[39m
     [33m[2mâœ“[22m[39m should process a real epub file (Alice in Wonderland) and extract metadata + cover [33m 358[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/providers/OpenAIProvider.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/extractSentences.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 49[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/providers/LemonFoxProvider.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m src/store/useTTSStore.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/processors/Sanitizer.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/TextSegmenter.punctuation.test.ts [2m([22m[2m128 tests[22m[2m)[22m[32m 32[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioPlayerService_Resume.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioPlayerService_StatusCompleted.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 9[2mms[22m[39m
[90mstderr[2m | src/components/reader/tests/LexiconManager.test.tsx[2m > [22m[2mLexiconManager[2m > [22m[2mshould populate test input when initialTerm is provided
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/reader/tests/LexiconManager.test.tsx[2m > [22m[2mLexiconManager[2m > [22m[2mshould not populate test input when initialTerm is not provided
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/reader/tests/LexiconManager.test.tsx[2m > [22m[2mLexiconManager[2m > [22m[2mshould render test buttons
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/reader/tests/LexiconManager.test.tsx[2m > [22m[2mLexiconManager[2m > [22m[2mshould disable current replacement button when not editing
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32mâœ“[39m src/components/reader/tests/LexiconManager.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[33m 731[2mms[22m[39m
     [33m[2mâœ“[22m[39m should populate test input when initialTerm is provided [33m 413[2mms[22m[39m
 [32mâœ“[39m src/components/library/LibraryView_Performance.test.tsx [2m([22m[2m1 test[22m[2m)[22m[32m 91[2mms[22m[39m
[90mstderr[2m | src/components/library/EmptyLibrary.test.tsx[2m > [22m[2mEmptyLibrary[2m > [22m[2mhandles demo book loading failure
[22m[39mError loading demo book: Error: Failed to load demo book
    at handleLoadDemo [90m(/app/[39msrc/components/library/EmptyLibrary.tsx:29:31[90m)[39m

 [32mâœ“[39m src/components/library/EmptyLibrary.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 171[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/TextSegmenter.configurable.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 33[2mms[22m[39m
 [32mâœ“[39m src/components/reader/tests/AnnotationPopover.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[32m 117[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/TTSCache.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/AudioElementPlayer.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 10[2mms[22m[39m
[90mstdout[2m | src/hooks/useEpubReader_Security.test.tsx[2m > [22m[2museEpubReader Security[2m > [22m[2mshould NOT add allow-scripts to the iframe sandbox
[22m[39mSandbox attribute: allow-same-origin

 [32mâœ“[39m src/hooks/useEpubReader_Security.test.tsx [2m([22m[2m1 test[22m[2m)[22m[32m 65[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/TextSegmenter.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/LexiconService.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m src/lib/csv.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m src/lib/cfi-utils.fuzz.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/TextSegmenter.regression.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 24[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/LexiconServiceSort.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/providers/PiperProvider.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 25[2mms[22m[39m
 [32mâœ“[39m src/components/library/BookListItem.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 104[2mms[22m[39m
 [32mâœ“[39m src/lib/search.repro.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 55[2mms[22m[39m
[90mstderr[2m | src/hooks/use-local-storage.test.ts[2m > [22m[2museLocalStorage[2m > [22m[2mshould handle parsing errors gracefully
[22m[39mError reading localStorage key "test-key": SyntaxError: Unexpected token 'i', "invalid-json" is not valid JSON
    at JSON.parse (<anonymous>)
    at readValue [90m(/app/[39msrc/hooks/use-local-storage.ts:22:26[90m)[39m
    at mountState [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:16167:20[90m)[39m
    at Object.useState [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:16880:16[90m)[39m
    at useState [90m(/app/[39mnode_modules/[4mreact[24m/cjs/react.development.js:1622:21[90m)[39m
    at useLocalStorage [90m(/app/[39msrc/hooks/use-local-storage.ts:29:41[90m)[39m
    at [90m/app/[39msrc/hooks/use-local-storage.test.ts:50:41
    at TestComponent [90m(/app/[39mnode_modules/[4m@testing-library/react[24m/dist/pure.js:331:27[90m)[39m
    at renderWithHooks [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:15486:18[90m)[39m
    at mountIndeterminateComponent [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:20103:13[90m)[39m
Error reading localStorage key "test-key": SyntaxError: Unexpected token 'i', "invalid-json" is not valid JSON
    at JSON.parse (<anonymous>)
    at readValue [90m(/app/[39msrc/hooks/use-local-storage.ts:22:26[90m)[39m
    at [90m/app/[39msrc/hooks/use-local-storage.ts:51:20
    at commitHookEffectListMount [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:23189:26[90m)[39m
    at commitPassiveMountOnFiber [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24970:11[90m)[39m
    at commitPassiveMountEffects_complete [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24930:9[90m)[39m
    at commitPassiveMountEffects_begin [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24917:7[90m)[39m
    at commitPassiveMountEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:24905:3[90m)[39m
    at flushPassiveEffectsImpl [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27078:3[90m)[39m
    at flushPassiveEffects [90m(/app/[39mnode_modules/[4mreact-dom[24m/cjs/react-dom.development.js:27023:14[90m)[39m

 [32mâœ“[39m src/hooks/use-local-storage.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 45[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/SyncEngine.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m src/components/reader/tests/TTSQueue.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 260[2mms[22m[39m
 [32mâœ“[39m src/lib/search-engine.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mâœ“[39m src/hooks/useChapterDuration.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 22[2mms[22m[39m
[90mstderr[2m | src/components/ui/Dialog.test.tsx[2m > [22m[2mDialog[2m > [22m[2mrenders title and description when open
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/ui/Dialog.test.tsx[2m > [22m[2mDialog[2m > [22m[2mrenders children content
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/ui/Dialog.test.tsx[2m > [22m[2mDialog[2m > [22m[2mcalls onClose when close button is clicked
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

[90mstderr[2m | src/components/ui/Dialog.test.tsx[2m > [22m[2mDialog[2m > [22m[2mrenders footer
[22m[39mWarning: Missing `Description` or `aria-describedby={undefined}` for {DialogContent}.

 [32mâœ“[39m src/components/ui/Dialog.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 574[2mms[22m[39m
[90mstdout[2m | src/lib/tts/TextSegmenter.perf.test.ts[2m > [22m[2mTextSegmenter Performance[2m > [22m[2mavoids unnecessary string splitting during post-processing
[22m[39mSplit called 0 times for 100 sentences.

 [32mâœ“[39m src/lib/tts/TextSegmenter.perf.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m src/store/useReaderStore.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/lexiconSample.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m src/lib/tts/CostEstimator.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m src/store/useToastStore.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m src/lib/utils.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m src/hooks/use-local-storage-bug.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 21[2mms[22m[39m
[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Unhandled Errors [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m
[31m[1m
Vitest caught 1 unhandled error during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.[22m[39m

[31mâŽ¯âŽ¯âŽ¯âŽ¯[39m[1m[41m Unhandled Rejection [49m[22m[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m
[31m[1mError[22m: Transaction Failed[39m
[36m [2mâ¯[22m src/db/DBService.readingHistory.test.ts:[2m146:38[22m[39m
    [90m144| [39m                    get: vi.fn().mockRejectedValue(new Error('Transactâ€¦
    [90m145| [39m                })[33m,[39m
    [90m146| [39m                done[33m:[39m [33mPromise[39m[33m.[39m[34mreject[39m([35mnew[39m [33mError[39m([32m'Transaction Failed'[39m))[33m,[39m
    [90m   | [39m                                     [31m^[39m
    [90m147| [39m            }[33m;[39m
    [90m148| [39m            mockDB[33m.[39mtransaction[33m.[39m[34mmockReturnValue[39m(mockTx)[33m;[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m145:11[22m[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m915:26[22m[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m1240:20[22m[39m
[90m [2mâ¯[22m runWithTimeout node_modules/@vitest/runner/dist/index.js:[2m1206:10[22m[39m
[90m [2mâ¯[22m node_modules/@vitest/runner/dist/index.js:[2m1650:37[22m[39m
[90m [2mâ¯[22m Traces.$ node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:[2m115:27[22m[39m
[90m [2mâ¯[22m trace node_modules/vitest/dist/chunks/test.BT8LKgU9.js:[2m239:21[22m[39m
[90m [2mâ¯[22m runTest node_modules/@vitest/runner/dist/index.js:[2m1650:12[22m[39m

[31mThis error originated in "[1msrc/db/DBService.readingHistory.test.ts[22m" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.[39m
[31mâŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯[39m


[2m Test Files [22m [1m[32m80 passed[39m[22m[90m (80)[39m
[2m      Tests [22m [1m[32m521 passed[39m[22m[2m | [22m[33m7 skipped[39m[90m (528)[39m
[2m     Errors [22m [1m[31m1 error[39m[22m
[2m   Start at [22m 07:08:01
[2m   Duration [22m 40.43s[2m (transform 3.95s, setup 18.31s, import 12.22s, tests 12.83s, environment 60.76s)[22m
