#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile.verification
#1 transferring dockerfile: 1.11kB 0.1s done
#1 DONE 0.1s

#2 resolve image config for docker-image://docker.io/docker/dockerfile:1
#2 DONE 0.8s

#3 docker-image://docker.io/docker/dockerfile:1@sha256:b6afd42430b15f2d2a4c5a02b919e98a525b785b1aaff16747d2f623364e39b6
#3 CACHED

#4 [internal] load metadata for mcr.microsoft.com/playwright/python:v1.48.0-jammy
#4 DONE 0.2s

#5 [internal] load .dockerignore
#5 transferring context: 98B done
#5 DONE 0.0s

#6 [ 1/12] FROM mcr.microsoft.com/playwright/python:v1.48.0-jammy@sha256:6bbd515848db4042068571135979b6ee6d330a794b28e037e3a6ccd7f2abfa26
#6 DONE 0.0s

#7 [internal] load build context
#7 transferring context: 18.03MB 0.2s done
#7 DONE 0.3s

#8 [ 7/12] RUN pip install pytest pytest-playwright pytest-xdist playwright==1.48.0
#8 CACHED

#9 [ 2/12] WORKDIR /app
#9 CACHED

#10 [ 5/12] COPY scripts ./scripts
#10 CACHED

#11 [ 3/12] RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - &&     apt-get install -y nodejs &&     node --version &&     npm --version
#11 CACHED

#12 [ 4/12] COPY package.json package-lock.json ./
#12 CACHED

#13 [ 6/12] RUN npm ci
#13 CACHED

#14 [ 8/12] RUN playwright install
#14 CACHED

#15 [ 9/12] COPY . .
#15 DONE 39.9s

#16 [10/12] RUN npm run build
#16 19.22
#16 19.22 > versicle@0.0.0 build
#16 19.22 > tsc -b && vite build
#16 19.22
#16 29.65 vite v7.3.0 building client environment for production...
#16 30.26 transforming...
#16 41.65 âœ“ 2178 modules transformed.
#16 44.45 rendering chunks...
#16 45.25 [plugin vite:reporter]
#16 45.25 (!) /app/node_modules/y-indexeddb/src/y-indexeddb.js is dynamically imported by /app/src/lib/BackupService.ts but also statically imported by /app/src/store/yjs-provider.ts, dynamic import will not move module into another chunk.
#16 45.25
#16 45.25 [plugin vite:reporter]
#16 45.25 (!) /app/src/store/yjs-provider.ts is dynamically imported by /app/src/lib/BackupService.ts but also statically imported by /app/src/App.tsx, /app/src/lib/BackupService.ts, /app/src/lib/migration/YjsMigration.ts, /app/src/lib/sync/FirestoreSyncManager.ts, /app/src/lib/sync/YjsSyncService.ts, /app/src/store/useAnnotationStore.ts, /app/src/store/useLibraryStore.ts, /app/src/store/usePreferencesStore.ts, /app/src/store/useReadingListStore.ts, /app/src/store/useReadingStateStore.ts, dynamic import will not move module into another chunk.
#16 45.25
#16 45.25 [plugin vite:reporter]
#16 45.25 (!) /app/src/store/useTTSStore.ts is dynamically imported by /app/src/lib/tts/LexiconService.ts but also statically imported by /app/src/components/GlobalSettingsDialog.tsx, /app/src/components/reader/ReaderControlBar.tsx, /app/src/components/reader/ReaderTTSController.tsx, /app/src/components/reader/ReaderView.tsx, /app/src/components/reader/TTSAbbreviationSettings.tsx, /app/src/components/reader/TTSQueue.tsx, /app/src/components/reader/UnifiedAudioPanel.tsx, /app/src/components/reader/UnifiedInputController.tsx, /app/src/components/ui/CompassPill.tsx, /app/src/hooks/useSectionDuration.ts, /app/src/hooks/useTTS.ts, /app/src/lib/tts/AudioContentPipeline.ts, /app/src/store/useLibraryStore.ts, dynamic import will not move module into another chunk.
#16 45.25
#16 45.25 [plugin vite:reporter]
#16 45.25 (!) /app/src/store/useLibraryStore.ts is dynamically imported by /app/src/lib/BackupService.ts, /app/src/lib/BackupService.ts but also statically imported by /app/src/App.tsx, /app/src/components/GlobalSettingsDialog.tsx, /app/src/components/library/DeleteBookDialog.tsx, /app/src/components/library/EmptyLibrary.tsx, /app/src/components/library/FileUploader.tsx, /app/src/components/library/LibraryView.tsx, /app/src/components/library/OffloadBookDialog.tsx, /app/src/components/library/ReprocessingInterstitial.tsx, /app/src/lib/migration/YjsMigration.ts, /app/src/store/selectors.ts, /app/src/store/useReadingStateStore.ts, dynamic import will not move module into another chunk.
#16 45.25
#16 49.31 computing gzip size...
#16 49.49 dist/registerSW.js                              0.13 kB
#16 49.49 dist/manifest.webmanifest                       0.36 kB
#16 49.49 dist/index.html                                 0.76 kB â”‚ gzip:   0.38 kB
#16 49.49 dist/assets/silence-B6oov6b9.ogg                4.12 kB
#16 49.49 dist/assets/search.worker-DyNrTPTN.js           5.22 kB
#16 49.49 dist/assets/white-noise-U8_pGdEo.ogg          201.37 kB
#16 49.49 dist/assets/index-DROifTTH.css                 63.77 kB â”‚ gzip:  11.53 kB
#16 49.49 dist/assets/rasterize-JS5G2XHH-B_d6BCN-.js      0.36 kB â”‚ gzip:   0.28 kB â”‚ map:     0.83 kB
#16 49.49 dist/assets/toBlob-byzRNT5x.js                  0.36 kB â”‚ gzip:   0.29 kB â”‚ map:     0.89 kB
#16 49.49 dist/assets/web-C4G6R-B9.js                     0.40 kB â”‚ gzip:   0.28 kB â”‚ map:     1.21 kB
#16 49.49 dist/assets/download-C2cmjSzx.js                0.64 kB â”‚ gzip:   0.42 kB â”‚ map:     1.53 kB
#16 49.49 dist/assets/web-B_OLZUiq.js                     0.87 kB â”‚ gzip:   0.30 kB â”‚ map:     2.02 kB
#16 49.49 dist/assets/toImg-DukqhQzw.js                   1.30 kB â”‚ gzip:   0.65 kB â”‚ map:     2.90 kB
#16 49.49 dist/assets/web-CzxOWp1O.js                     1.69 kB â”‚ gzip:   0.72 kB â”‚ map:     5.07 kB
#16 49.49 dist/assets/toCanvas-Bsmm5eIB.js                2.55 kB â”‚ gzip:   1.32 kB â”‚ map:     6.62 kB
#16 49.49 dist/assets/web-BqgDDHtb.js                     8.71 kB â”‚ gzip:   2.99 kB â”‚ map:    35.69 kB
#16 49.49 dist/assets/index-xrP4oqh4.js               1,908.42 kB â”‚ gzip: 589.80 kB â”‚ map: 8,980.08 kB
#16 49.49
#16 49.49 (!) Some chunks are larger than 500 kB after minification. Consider:
#16 49.49 - Using dynamic import() to code-split the application
#16 49.49 - Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
#16 49.49 - Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
#16 49.49 âœ“ built in 19.78s
#16 49.50
#16 49.50 PWA v1.2.0
#16 49.50 Building src/sw.ts service worker ("es" format)...
#16 50.55 vite v7.3.0 building client environment for production...
#16 50.55 transforming...
#16 50.77 âœ“ 67 modules transformed.
#16 50.79 rendering chunks...
#16 50.81 computing gzip size...
#16 50.81 dist/sw.mjs  20.71 kB â”‚ gzip: 7.11 kB â”‚ map: 161.90 kB
#16 50.81 âœ“ built in 264ms
#16 50.95
#16 50.95 PWA v1.2.0
#16 50.95 mode      injectManifest
#16 50.95 format:   es
#16 50.95 precache  21 entries (2697.91 KiB)
#16 50.95 files generated
#16 50.95   dist/sw.js
#16 50.95   dist/sw.js.map
#16 DONE 51.2s

#17 [11/12] COPY verification/docker_entrypoint.sh /app/verification/docker_entrypoint.sh
#17 DONE 29.0s

#18 [12/12] RUN chmod +x /app/verification/docker_entrypoint.sh
#18 DONE 43.2s

#19 exporting to image
#19 exporting layers
#19 exporting layers 11.4s done
#19 writing image sha256:df585beb9c12a8dc0f2ca74402afa3afdd775baeb632415f72798bed10007855 done
#19 naming to docker.io/library/versicle-verify done
#19 DONE 11.4s
ğŸƒ Running verification tests...
ğŸš€ Starting Vite Preview Server...
â³ Waiting for application to be ready at http://localhost:5173...

> versicle@0.0.0 preview
> vite preview --port 5173 --host

  âœ  Local:   http://localhost:5173/
  âœ  Network: http://172.17.0.2:5173/
âœ… Application is ready!
ğŸ§ª Running verification suite...
============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
plugins: xdist-3.8.0, playwright-0.7.2, base-url-2.1.0
created: 4/4 workers
4 workers [154 items]

........................................................................ [ 46%]
........................................................................ [ 93%]
..........                                                               [100%]
======================= 154 passed in 342.01s (0:05:42) ========================
ğŸš€ Running verification tests with pytest...
Executing: /usr/bin/python -m pytest -n auto verification/
ğŸ Tests finished with exit code 0
ğŸ Verification tests completed with exit code: 0
